<figure>
    {{ $url := .Get "thumb" | replaceRE "_st." "." }}
    {{ $random := delimit (shuffle (split (md5 $url) "" )) "" }}
    {{ $originalWidth := .Get "width" | float }}
    {{ $originalHeight := .Get "height" | float }}
    {{ $desiredWidth := 800 }}
    {{ $scaleFactor := div $desiredWidth $originalWidth | float }}
    {{ $scaledHeight := mul $scaleFactor $originalHeight | int }}
    <div class="pswp-gallery" id="gallery--{{$random}}">
        <a href="https://media.evkx.net/ehga/{{ $url }}" data-pswp-width="{{ .Get "width" }}" data-pswp-height="{{ .Get "height" }}" target="_blank">
            <img src="https://media.evkx.net/ehga/{{ .Get "thumb" }}" class="max-w-full h-auto" alt="{{ .Get "title" }}" title="{{ .Get "title" }}" width="{{ $desiredWidth }}" height="{{ $scaledHeight }}" target="_blank">
        </a>
    </div>
   <figcaption>
        <p class="text-lg text-center font-semibold">
            {{ .Get "title" }}
        </p>
    </figcaption>
</figure>
<script type="module">
    import PhotoSwipeLightbox from '/js/photoswipe-lightbox.esm.js';
      const lightbox = new PhotoSwipeLightbox({
         gallery: '#gallery--{{$random}} a',
          pswpModule: () => import('/js/photoswipe.esm.js')
      });
  lightbox.init();
  </script>